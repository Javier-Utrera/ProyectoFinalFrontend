<section class="mis-relatos">
  <div class="container">
    <h2 class="page-title">Mis relatos</h2>

    <app-buscador [idiomas]="['es','en','fr']" [numEscritoresOpts]="[1,2,3,4,5]" [initialFilters]="filtrosActivo"
      (paramsChange)="onBuscar($event)"></app-buscador>

    @if (loading) {
    <div class="spinner-border" role="status"></div>
    }
    @else if (relatos.length === 0) {
    <p>No tienes relatos aún.</p>
    }
    @else {
    <div class="cards-grid">
      @for (relato of relatos; track relato.id) {
      <div class="relato-item d-flex flex-column">
        <app-relatocard [relato]="relato" origen="mis-relatos"></app-relatocard>

        <div class="btn-group mt-3" role="group">
          <button class="btn btn-sm btn-outline-primary" (click)="verRelato(relato.id)">
            Leer
          </button>
          <button class="btn btn-sm btn-outline-secondary" (click)="editarRelato(relato.id)">
            Escribir
          </button>
          <button class="btn btn-sm btn-outline-success" (click)="marcarListo(relato.id)">
            Marcar listo
          </button>
          <button class="btn btn-sm btn-outline-danger" (click)="eliminarRelato(relato.id)">
            Eliminar relato
          </button>
        </div>
      </div>
      }
    </div>

    <!-- Paginación -->
    <div class="d-flex justify-content-between align-items-center my-4">
      @if (page > 1) {
      <button class="btn btn-outline-primary" (click)="prevPage()">« Anterior</button>
      }
      @else {
      <button class="btn btn-outline-primary" disabled>« Anterior</button>
      }

      <span>Página {{ page }} de {{ totalPages }}</span>

      @if (page < totalPages) { <button class="btn btn-outline-primary" (click)="nextPage()">Siguiente »</button>
        }
        @else {
        <button class="btn btn-outline-primary" disabled>Siguiente »</button>
        }
    </div>
    }
  </div>
</section>